<div class="formacion-academica-form">
  <button *ngIf="!showForm && !isEditMode" class="btn btn-primary" (click)="toggleForm()">
    + Agregar Formación Académica
  </button>

  <div *ngIf="showForm" class="form-container">
    <h4>{{ isEditMode ? 'Editar' : 'Nueva' }} Formación Académica</h4>

    <!-- Error -->
    <div *ngIf="error" class="error-message">
      {{ error }}
    </div>

    <form [formGroup]="formacionForm" (ngSubmit)="onSubmit()">
      <div class="form-grid">
        <div class="form-group">
          <label for="nivel_formacion">Nivel de Formación *</label>
          <select id="nivel_formacion" formControlName="nivel_formacion"
                  [class.error]="f['nivel_formacion'].invalid && f['nivel_formacion'].touched">
            <option value="">Seleccione un nivel</option>
            <option *ngFor="let nivel of nivelesFormacion" [value]="nivel">
              {{ nivel }}
            </option>
          </select>
          <div *ngIf="f['nivel_formacion'].invalid && f['nivel_formacion'].touched" class="error-text">
            Nivel de formación es requerido
          </div>
        </div>

        <div class="form-group">
          <label for="titulo">Título Obtenido *</label>
          <input type="text" id="titulo" formControlName="titulo"
                 [class.error]="f['titulo'].invalid && f['titulo'].touched">
          <div *ngIf="f['titulo'].invalid && f['titulo'].touched" class="error-text">
            Título es requerido
          </div>
        </div>

        <div class="form-group">
          <label for="institucion">Institución Educativa *</label>
          <input type="text" id="institucion" formControlName="institucion"
                 [class.error]="f['institucion'].invalid && f['institucion'].touched">
          <div *ngIf="f['institucion'].invalid && f['institucion'].touched" class="error-text">
            Institución es requerida
          </div>
        </div>

        <div class="form-group">
          <label for="anio_graduacion">Año de Graduación</label>
          <input type="number" id="anio_graduacion" formControlName="anio_graduacion"
                 min="1900" [max]="currentYear">
        </div>

        <div class="form-group">
          <label for="pais">País</label>
          <input type="text" id="pais" formControlName="pais">
        </div>

        <div class="form-group">
          <label for="documento_titulo">Documento del Título (URL)</label>
          <input type="text" id="documento_titulo" formControlName="documento_titulo">
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn btn-primary" [disabled]="saving">
          {{ saving ? 'Guardando...' : (isEditMode ? 'Actualizar' : 'Guardar') }}
        </button>
        <button type="button" class="btn btn-secondary" (click)="onCancel()" [disabled]="saving">
          Cancelar
        </button>
      </div>
    </form>
  </div>
</div>